import { useLocalSearchParams } from 'expo-router'
import { View } from 'react-native'
import { useState } from 'react'
import { Container } from '../../../components/Container'
import TaskHeader from '../../../components/TaskHeader'
import MediaDisplay from '../../../components/MediaDisplay'
import ConversationContent from '../../../components/ConversationContent'
import BottomInputButton from '../../../components/BottomInputButton'
import { getVibeImage } from 'utils/getVibeImage'

// 定义消息类型
interface Message {
    id: string;
    speaker: {
        name: string;
        role: 'host' | 'user' | 'expert';
    };
    content: string;
}

const Task = () => {
    const { taskId } = useLocalSearchParams()
    console.log("🚀 ~ Task ~ taskId:", taskId)
    
    // 初始化消息状态
    const [messages, setMessages] = useState<Message[]>([
        {
            id: '1',
            speaker: { name: '林知远', role: 'expert' as const },
            content: '大家好，欢迎收听「知远聊科技」，我是主持人林知远。今天我们聊一个大家最近可能都在关注的话题——哪些工作可能会被AI替代？最近有不少新闻让大家既兴奋又担忧，比如某大厂用AI替代了80%的客服人员，还有内容运营的朋友分享说AI帮他们效率提升了3倍，但同时也担心自己的工作会不会被取代。\n\n我们先从客服这个例子聊起。AI客服确实能处理大量重复性问题，节省人力成本，但遇到复杂情况时，还是需要人工介入。那大家觉得，除了客服，还有哪些岗位可能面临类似的情况？比如数据录入、基础翻译，或者一些流水线上的工作？\n\n不过，AI带来的不只是替代。世界经济论坛的报告也提到，未来五年AI可能会淘汰一些岗位，但也会创造新的机会，比如数据分析师、AI训练师这样的角色。这其实提醒我们，技术的进步往往伴随着就业结构的变化。\n\n那我们不妨想一想，面对这样的趋势，个人和企业可以怎么应对？是加强学习新技能，还是调整职业方向？希望今天的讨论能给大家带来一些启发。接下来，我们会听听不同嘉宾的看法，一起展开更深入的探讨。'
        },
        {
            id: '2',
            speaker: { name: '陈博士', role: 'expert' as const },
            content: '各位听众朋友好，我是陈博士。今天我们来谈谈AI对就业的影响，特别是近期大家关注的岗位替代问题。\n\n首先，从数据来看，世界经济论坛在2024年1月发布的《未来就业报告》明确指出：未来五年，AI预计将创造6900万个新岗位，同时淘汰8300万个岗位。这意味着净减少约1400万个岗位，占总就业的2%左右。这个数字看似惊人，但我们需要放在历史背景下理解——工业革命时期，纺织机械的出现也曾导致大量手工业者失业，但最终催生了工厂制等新的就业形态。\n\n具体到客服岗位的替代，麦肯锡2023年的研究报告显示，约有70%的客服工作可以实现自动化。某大厂将300人团队裁至60人，这个案例符合这一趋势。但值得注意的是，被保留的60个岗位正是需要人类情感理解和复杂问题解决能力的高级客服——这说明AI替代的主要是重复性高、规则明确的工作。\n\n与此同时，我们必须看到岗位创造的一面。同一份报告指出，数据分析师、AI系统训练师、人机协作协调员等新兴职业的需求正在快速增长。以内容运营为例，虽然AI可以完成初稿撰写等基础工作，但策略制定、品牌调性把控、情感共鸣创造等高端工作仍然需要人类专业人才。\n\n从经济学角度看，这是一种典型的技术性失业与结构性转型并存的阶段。历史告诉我们，每当重大技术革新出现，短期阵痛不可避免，但长期来看，劳动生产率提升将创造新的需求和工作机会。重要的是如何通过技能再培训和政策引导，帮助劳动力完成过渡。\n\n作为劳动经济学家，我建议打工人们：不必过度恐慌，但需要主动适应。重点关注那些需要人类独有技能的工作领域，比如创造性思维、情感互动和复杂决策。同时，政府和企业的再培训投入至关重要——根据OECD的数据，在数字化转型中，接受过技能升级的劳动者收入平均提高17-23%。\n\n谢谢大家的关注，我们下期继续探讨。'
        },
        {
            id: '3',
            speaker: { name: '小李', role: 'expert' as const },
            content: '（叹气）陈博士您说得很有道理，但说实话，听完我更焦虑了…我是做内容运营的小李，每天真的亲眼看着AI抢活干啊！上周我们部门刚用AI工具自动生成节日文案，原来要实习生加班写三天的东西，现在十分钟搞定——实习生直接被调岗了，这谁不怕啊？\n\n而且您说客服只裁普通岗位？可我们公司连高级客服都开始用AI了！上次我投诉会员问题，电话那头根本是机器人，反复说“理解您的心情”但完全解决不了问题，最后我气得直接挂电话…这哪是“情感理解”，分明是“人工智障”啊！（苦笑）\n\n是，报告说会创造新岗位，可“AI训练师”、“人机协作协调员”这些词听着就离我们普通人很远啊！我每天还在那苦哈哈地调标题、追热点，突然告诉我要去学Python训练模型？我连Excel函数都用不利索呢…\n\n更扎心的是，现在刷知乎全是什么“AI一个月取代我十年经验”、“程序员被GPT-4抢饭碗”的帖子…就连我写周报都开始用ChatGPT生成了（小声），真怕哪天老板发现这活儿AI比我干得还好，直接把我优化了…\n\n说真的，我不反对科技进步，但能不能给我们普通打工人一点缓冲时间？那些经济学家总说“长期会更好”，可短期房贷谁帮我还啊？！（揉头发）现在每天上班都像在赛跑，生怕跑得比AI慢一步…所以陈博士，能不能别光讲数据，教点实际的？比如现在该学什么技能才不会被淘汰？或者有没有公司真的在帮员工转型而不是直接裁员？我们真的需要救命稻草啊…'
        },
        {
            id: '4',
            speaker: { name: '林知远', role: 'expert' as const },
            content: '（温和地笑着）小李的焦虑我特别能理解。其实我们换个角度想，每次技术革新都会带来阵痛，但最终都会催生新的机会。陈博士刚才提到，像数据录入、客服这些重复性高的工作确实容易被替代，但创意类、情感交流类的工作反而可能因为AI的辅助变得更高效。\n\n（转向嘉宾）那我们听听王总监的看法，您作为人力资源专家，在实际招聘中观察到哪些岗位正在被AI影响？又有哪些新兴岗位在出现呢？\n\n（稍作停顿）其实我注意到一个很有意思的现象：现在很多企业开始设立「人机协作专员」这样的职位，专门负责优化AI和人工的配合流程。小李做内容运营的话，是不是可以考虑往AI内容策展方向转型？'
        },
        {
            id: '5',
            speaker: { name: '陈博士', role: 'expert' as const },
            content: '（语气沉稳，推了推眼镜）小李，我理解你的焦虑。但请允许我从数据和历史的角度，为你提供一个更全面的视角。\n\n根据麦肯锡2023年的研究报告，到2030年，全球约有15%的工作活动可能被自动化技术取代——但这个数字背后有个关键细节：同时会有10%的新工作岗位被创造出来。更重要的是，超过60%的职业将会发生工作内容的转型，而不是简单的消失。\n\n具体到内容运营领域，世界经济论坛的数据显示，文案创作、内容优化这类工作的自动化潜力确实较高，预计达到40-50%。但同一份报告也指出，对\"人机协作专员\"、\"AI内容策略师\"等新兴岗位的需求正在快速增长，年增幅超过25%。\n\n历史总是给我们启示。19世纪的工业革命让纺织工人减少了80%，但创造了铁路、机械制造等新行业；20世纪末的互联网浪潮淘汰了打字员、电话接线员，却催生了网页设计师、数字营销师等职业。每一次技术革命都会经历短期阵痛，但长期来看都带来了更高的生产力和更多元的就业机会。\n\n你现在看到的AI生成文案，本质上是将重复性工作自动化，解放人力去从事更需要创造力、策略性和情感连接的工作。我建议你关注两个数据：一是企业对新岗位的招聘增速（目前年增18%），二是人机协作岗位的薪资溢价（平均高出传统岗位23%）。\n\n（稍作停顿）焦虑是正常的，但更好的应对方式是主动适应这种结构性转变。不妨思考如何将你的内容运营经验与AI工具结合，向\"内容策略师\"或\"用户体验优化师\"等新兴角色转型。记住，技术替代的是任务，而不是人的价值。'
        },
        {
            id: '6',
            speaker: { name: '小李', role: 'expert' as const },
            content: '（叹气）哎，说实话，听您说这些数据我反而更焦虑了。您看啊，上周我们公司内容团队刚裁了两个实习生——就是因为老板买了AI写稿工具，说一天能生成200篇电商文案，还不用交五险一金。我现在每天上班都提心吊胆的，生怕哪天我的工位上就摆台电脑，上面贴个纸条写着「本岗位已由GPT-4接管」。（苦笑）\n\n真的，现在刷知乎全是「AI取代运营」「Midjourney干掉设计师」的帖子。昨天看到个新闻说某大厂客服团队裁了30%，换成AI语音系统，结果用户投诉量暴涨——但老板不在乎啊，人家算的是成本账！我们打工人算什么？算人力成本！\n\n您说会创造新岗位，可「人机协作专员」这种职位听着就虚。我现在用ChatGPT写周报都要偷偷改好几遍，生怕被老板发现这玩意儿写得比我好。上次让它生成节日海报文案，结果直接抄了竞品的slogan，差点酿成事故！最后背锅的不还是我？\n\n说到历史案例更扎心了——工业革命时那些失业的纺织工人，有几个真能转型成铁路工程师的？现在要求我们运营既要会写文案又要懂AI调教，还要做数据分析，工资却没见涨。昨天看到个招聘：「AI内容策略师，5年经验，精通GPT+SD+数据分析，薪资8-12K」——这不就是逼着打工人卷成超人吗？\n\n（声音突然低落）其实我不反对AI，上周还用它生成了一百条微博话题。但每次看到生成的内容，我就忍不住想：要是哪天它连热点追梗都会了，是不是就该给我发离职证明了？我们现在就像给AI当校对员，它写初稿，我们改错别字——但这能算核心竞争力吗？\n\n最后说个真实的：昨天我偷偷测试用AI生成离职报告，它居然连「感谢公司培养」的套话都写得比我真情实感...这还让不让人活了！（强行振作）算了算了，我还是先去学学怎么给AI提示词吧，至少争取当最后一个被优化的...'
        },
        {
            id: '7',
            speaker: { name: '林知远', role: 'expert' as const },
            content: '（语气温和，带着理解）我能理解你的担忧，确实，当我们看到身边发生这样的变化时，很难不感到焦虑。不过，或许我们可以试着从更全面的角度来看待这个问题。\n\n（稍作停顿，转向其他嘉宾）那我们听听另一位嘉宾的看法。李教授，从您的研究来看，哪些类型的工作更容易受到自动化的影响？而哪些工作反而可能因为AI的出现变得更加重要？'
        },
        {
            id: '8',
            speaker: { name: '陈博士', role: 'expert' as const },
            content: '（略微停顿，语气沉稳）我理解您的焦虑，这种切身感受确实比宏观数据更令人不安。但请允许我用世界经济论坛《2023年未来就业报告》的数据来说明：到2027年，全球预计将出现6900万个新工作岗位，同时消失8300万个岗位——净减少约1400万，占当前就业总量的2%。\n\n（推眼镜）具体到容易被替代的工作，麦肯锡研究显示：数据录入、基础客服、简单文书处理等重复性认知劳动，被自动化替代的风险超过60%。您提到的文案生成正是典型例子——但请注意，需要创造性策略、情感互动和复杂决策的岗位，替代率普遍低于30%。\n\n（切换幻灯片声）历史上看，19世纪工业革命时，纺织工人恐慌程度不亚于今天。但最终催生了铁路、电力等新行业，就业总量反而增长。关键不在于「是否被替代」，而在于「如何转型」。当前AI带来的不是就业末日，而是像拖拉机替代锄头时，农民需要学习操作农机一样的技能升级。\n\n（语气稍缓）您公司裁员实习生却保留资深编辑，恰恰印证了这个规律：AI替代的是标准化生产环节，而人类的价值正在向创意策划、情感连接和系统管理等高阶能力迁移。我的建议是：把焦虑转化为学习新工具的动力——毕竟历史上从未出现过技术倒退，但适应变革的人始终能找到出路。'
        },
        {
            id: '9',
            speaker: { name: '小李', role: 'expert' as const },
            content: '（叹气）唉，听到这些数据我更焦虑了...您说消失8300万个岗位，新创6900万个，可那净减少的1400万岗位里，会不会就有我一个啊？\n\n我们公司上个月就用AI写手替代了三个实习生——真的就是一夜之间，组长在群里发了个AI生成的节日文案，直接说\"以后这种基础内容不用人写了\"。我现在自己写稿都先让AI生成个初稿，改得战战兢兢的，生怕哪天老板发现AI写得比我好...\n\n（苦笑）您说创造性工作安全，可我们运营每天要写10篇推文、5个短视频脚本，现在AI连热点都能追了，上周有个爆款文案就是AI生成的！连用户都在评论区夸\"小编真有才\"——这讽刺不讽刺？\n\n我室友做客服的更惨，他们公司上线智能客服后裁了半个团队，现在剩下的人天天培训怎么\"配合AI工作\"，说白了就是给AI打补丁。上次她半夜哭着跟我说，感觉自己就是个高级标点符号修正器...\n\n（声音提高）经济学家总说会有新岗位，可新岗位在哪儿呢？是说我们要全部转行去当AI提示词工程师吗？我大学学的是文科啊！现在让我去学编程跟科班出身的卷？这跟让马车夫去造汽车有什么区别...\n\n其实我不是反对AI，我天天用ChatGPT查资料做表格。但您说技能升级，普通打工人哪来的时间和资源？我每天加班到九点，周末只想瘫着，报个线上课听了三节就睡着了——这才是真实情况啊！\n\n（无奈）最后说句实在的，您举的拖拉机例子...当时肯定也有老农民学不会操作农机被淘汰吧？现在我怕的就是成为那个学不会新农机的老农民啊...'
        },
        {
            id: '10',
            speaker: { name: '林知远', role: 'expert' as const },
            content: '（温和地笑了笑）听起来您对这个数字确实感到有些担忧呢。不过让我们先别急着下结论——其实这个净减少的1400万个岗位，背后藏着很多值得探讨的细节。\n\n那我们不妨先听听看，各位嘉宾觉得哪些类型的工作最可能被AI替代？比如我们知道一些重复性高、规则明确的工作，像是数据录入、生产线质检这类岗位，确实正在被自动化技术取代。不过（转向另一位嘉宾），您之前提到过一个很有意思的观点，说AI其实也在创造新的就业机会？\n\n（稍作停顿）我注意到现场有嘉宾想发言，那我们听听另一位的看法。您认为除了技术性岗位，还有哪些领域可能会受到影响？比如创意类工作，或者需要人际互动的工作？\n\n其实说到这里，我觉得我们可以换个角度思考：历史上每次技术革命都会带来就业结构的变化，但最终都催生了新的职业形态。就像当年汽车取代马车夫，但也创造了整个汽车产业生态。（语气转为安抚）所以或许我们不该只盯着消失的岗位，更要关注如何适应这个转变过程。\n\n不知道各位嘉宾是否也这样认为？我们可以从个人适应和社会支持两个层面来聊聊这个问题。'
        },
        {
            id: '11',
            speaker: { name: '陈博士', role: 'expert' as const },
            content: '（语气冷静而沉稳）感谢您分享这个真实案例，这确实反映了当前劳动力市场的动态变化。根据麦肯锡2023年最新研究，行政支持类和初级文书工作确实是受自动化影响最显著的领域，预计到2030年，这类岗位的需求可能下降15%-20%。\n\n但请允许我提供一个更全面的视角。世界经济论坛《未来就业报告》显示，虽然AI将取代约8300万个工作岗位，但同时会创造6900万个新岗位。更重要的是，这些新岗位往往具有更高的生产价值和薪酬水平。以您提到的内容创作领域为例，虽然基础文案工作受到影响，但数字内容策划、AI训练师等新兴岗位的需求正在快速增长，年增长率达到24%。\n\n历史上看，这种结构性转变并非首次。20世纪初农业机械化使美国农业就业人口从40%降至2%，但同时催生了制造业和服务业的大规模就业。关键不在于岗位数量的简单增减，而在于劳动力技能的转型升级。\n\n我理解您的焦虑，但数据表明，真正面临高风险的是高度重复性、低创造性的工作任务。根据OECD研究，只有14%的工作岗位面临完全自动化的高风险，而超过60%的工作岗位将会与AI形成互补关系。\n\n建议关注那些需要人类独特优势的领域：复杂问题解决、情感智能和创造性工作。这些能力恰恰是AI难以替代的，也是未来劳动力市场的价值增长点。'
        },
        {
            id: '12',
            speaker: { name: '小李', role: 'expert' as const },
            content: '（叹气）哎，听到这些数据我真的更焦虑了...您说的这些新岗位，什么AI训练师、数字策划，听着都很高大上，但对我们这些普通打工人来说真的遥不可及啊！\n\n我上周就看到新闻，某大厂直接用AI替代了80%的实习生，连我们公司都在用ChatGPT写推文和活动文案了。我每天上班都在想，说不定明天HR就找我谈话说“小李啊，AI比你写得快还便宜”...（苦笑）\n\n说实话，我现在已经养成习惯了，每天刷职场论坛都在看“哪些工作最容易被AI取代”这种帖子。看到有人说客服、翻译、甚至初级程序员都在危险名单里，我就头皮发麻——这不就是我们这些普通文科生最常做的工作类型吗？\n\n经济学家总说会创造新岗位，但转型哪有那么容易？我大学学的是新闻传播，现在让我去学编程或者AI训练，先不说学费多贵，公司会愿意培养我们这些“老人”吗？更可能直接招个计算机专业的应届生吧！\n\n而且说真的，我现在每天的工作已经越来越像AI助理了——帮AI修改文案，给AI打标签，甚至要帮AI背锅 when它写错了东西...（无奈）有时候觉得自己就是个“人形修正带”，这种工作真的能长久吗？\n\n我知道AI是大势所趋，但就没人关心下我们这些普通打工人的生存问题吗？每次看到大佬们说“要拥抱变化”，我都想说：我们当然想拥抱啊，但总得先让我们活下去吧？！'
        },
        {
            id: '13',
            speaker: { name: '林知远', role: 'expert' as const },
            content: '（温和地笑了笑）我能理解你的焦虑感，确实当我们谈论这些新兴职业时，难免会让人觉得有些距离感。不过让我们换个角度想想——其实每个时代的技术变革都会带来这样的转变，就像当年汽车取代马车夫，但同时创造了整个汽车产业的大量就业机会。\n\n那我们不妨听听现场嘉宾的看法：您觉得在AI时代，哪些类型的工作反而会变得更加重要？比如需要人类情感连接的工作，或者是需要创造性思维的工作？'
        },
        {
            id: '14',
            speaker: { name: '陈博士', role: 'expert' as const },
            content: '（语气沉稳，推了推眼镜）我理解您的焦虑，但请允许我用数据来呈现更完整的图景。根据麦肯锡2023年最新研究，到2030年，全球约有15%的工作活动可能被自动化替代——但这个数字需要结合另一个数据来看：同期将产生的新工作岗位预计占总就业的10-12%。\n\n（调出数据图表）具体到容易被替代的工作类型，主要集中在重复性高、规则明确的任务。例如数据录入员（替代风险78%）、生产线质检员（72%）、基础客服（68%）。这些岗位的共性是需要处理标准化信息流，这正是当前AI技术最擅长的领域。\n\n（切换幻灯片）但历史上每次技术革命都呈现类似规律：19世纪工业革命时，60%的农业岗位消失，却催生了制造业和服务业新岗位；2000年互联网泡沫破裂时，传统文书岗位减少27%，但创造了软件工程、数字营销等新职业。根据世界经济论坛测算，AI推动的转型将创造9700万个新岗位，虽然其中部分岗位需要新技能。\n\n（语气转为缓和）我建议关注两个关键趋势：一是\"人机协作\"岗位正在快速增长，比如医疗影像分析师需要同时掌握医学知识和AI工具使用；二是企业普遍采用\"技能再投资\"策略，亚马逊去年就投入12亿美元对30万员工进行数字技能培训。\n\n转型期的阵痛确实存在，但历史表明，最终就业市场会找到新的平衡点。重要的是保持学习弹性，就像当年从农业社会向工业社会转型时，我们的祖辈也需要学会操作机器而不是仅依靠锄头。'
        },
        {
            id: '15',
            speaker: { name: '小李', role: 'expert' as const },
            content: '（叹气）哎呀，听到这些数据我头都大了...您说15%的工作被替代，但新岗位只有10-12%，那剩下3%的人去哪啊？我就是那3%怎么办啊！\n\n我们公司上个月就用AI写稿工具替代了两个实习生的活，现在连校对都让系统自动做了。上周开会老板还说\"以后基础文案都可以用AI生成，大家要提升创意价值\"——可我每天写电商文案、追热点、排版，80%都是重复劳动啊！这不就是说我们这种内容运营最危险吗？\n\n（语气激动）您说历史会创造新岗位，可我是文科生啊！看到那些\"人机协作\"要求既懂专业又会用AI工具，我都焦虑得睡不着。上次试着学Python，看了三天教程就放弃了，现在让我转型做医疗影像分析师？（自嘲）我连自己体检报告都看不明白...\n\n真不是我不愿意学，但公司培训都是画大饼！说什么\"数字技能培训\"，其实就是扔几个在线课程链接。人家亚马逊能投12亿美元培训，我们公司连12块钱的慕课会员都不舍得买！\n\n（压低声音）说实话我现在天天刷到AI新闻就心慌。昨天用ChatGPT写周报，它居然比我写得还流畅...连我自己都想把自己开除了！（苦笑）您说保持学习弹性，可我们天天加班到10点，回家只想躺着刷短视频，哪还有精力学新技能啊...\n\n最后问句实在的——您觉得像我们这种做内容运营的，到底该怎么活下去啊？总不能都去送外卖吧？'
        },
        {
            id: '16',
            speaker: { name: '林知远', role: 'expert' as const },
            content: '（背景音效渐弱，进入主持人口播）  \n大家好，我是林知远，欢迎回到《明日职场》。今天我们的讨论非常精彩，几位嘉宾从不同角度分享了关于“哪些工作可能被AI取代”的观点。  \n\n刚才我们听到了很多有意思的观察：比如李教授提到，一些重复性高、规则明确的工作——像是数据录入、客服，甚至部分翻译和写作任务，确实面临自动化的挑战。而王工程师则补充说，AI在图像识别、医疗诊断这些领域也展现出很强的潜力，可能会改变一些专业岗位的工作方式。  \n\n不过，小张也从人文角度提醒我们，创造力、情感交流和复杂决策这类工作，AI目前还难以完全替代，更重要的是人如何与AI协作，而不是单纯被取代。  \n\n（稍作停顿，语气温和）  \n其实总结下来，技术的进步从来不是要取代人类，而是重新定义工作的价值。就像工业革命时期，机器取代了部分体力劳动，但也创造了全新的职业机会。  \n\n那么，在节目的最后，我想请各位用一两句话分享一下：面对AI时代，你认为最重要的职场能力是什么？我们从李教授开始吧——  \n\n（自然过渡，给嘉宾发言空间，同时为收尾铺垫）'
        }
    ]);

    const handleSendMessage = (message: string) => {
        console.log('New message from user:', message);
        
        // 创建新的用户消息
        const newMessage: Message = {
            id: Date.now().toString(), // 使用时间戳作为简单的ID
            speaker: { name: '', role: 'user' },
            content: message
        };
        
        // 将新消息追加到消息列表中
        setMessages(prevMessages => [...prevMessages, newMessage]);

        // 模拟 Agent 回复（延迟1-2秒）
        setTimeout(() => {
            const agentReplies = [
                "That's a great question! Let me think about that...",
                "Interesting perspective! Here's what I think about multi-agent systems in that context...",
                "You've touched on a key point there. In terms of MAS applications...",
                "Excellent observation! This relates to some cutting-edge research in AI collaboration...",
                "That's exactly the kind of thinking we need in this field. Consider this aspect...",
                "Your question highlights an important challenge in multi-agent coordination...",
                "I appreciate your engagement with this topic. From a technical standpoint...",
                "That's a sophisticated way to look at it. In practice, what we're seeing is..."
            ];

            // 随机选择回复类型（主持人或专家）
            const isHost = Math.random() > 0.5;
            const agentReply: Message = {
                id: (Date.now() + 1).toString(),
                speaker: { 
                    name: isHost ? 'Alex' : 'Dr. Lee', 
                    role: isHost ? 'host' : 'expert' 
                },
                content: agentReplies[Math.floor(Math.random() * agentReplies.length)]
            };

            setMessages(prevMessages => [...prevMessages, agentReply]);
        }, 1000 + Math.random() * 1000); // 1-2秒随机延迟
    };

    const handlePlayPause = () => {
        console.log('Play/Pause media');
        // TODO: 处理播放/暂停逻辑
    };

    return (
        <Container>
            <View className="flex-1">
                {/* 顶部标题区域 */}
                <TaskHeader title="会被 AI 取代的工作有什么" />
                
                {/* 展示区域 */}
                <MediaDisplay
                    imageSource={getVibeImage(taskId as string)}
                    onPlayPause={handlePlayPause}
                />
                
                {/* 会话内容区域 */}
                <ConversationContent messages={messages} />
                
                {/* 底部输入按钮 */}
                <BottomInputButton onSendMessage={handleSendMessage} />
            </View>
        </Container>
    )
}

export default Task